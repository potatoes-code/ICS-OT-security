<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>DRAGOS</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="23c2e0bc-559c-8025-8deb-cacdce36bffb" class="page sans"><header><h1 class="page-title">DRAGOS</h1><p class="page-description"></p></header><div class="page-body"><p id="2412e0bc-559c-80f8-8195-df2dd8776e3d" class="">
</p><p id="2412e0bc-559c-8073-a384-f1f9ba1a8352" class="">This project explores an industrial security investigation using data from Dragos&#x27;  (BOTS) simulation. The environment mimics real-world ICS setups, including PLCs (Programmable Logic Controllers), sensors, and operator workstations. Using Splunk, I followed a series of scenario-based questions that guided me through analyzing alerts and logs. Although the questions pointed me in the right direction, I did investigation, asking what behavior looked unusual, what it might mean, and how it could impact the system. I focused on events like PLC status changes, SMB command shells, and CIP errors to understand how attackers might gain access, move through the environment, or manipulate physical processes. This gave me practical insight into how cyber threats can affect industrial systems and could shut down or damage critical operations.<br/><br/></p><p id="23c2e0bc-559c-80ff-bebf-c1e681d38a09" class=""><strong>Question:</strong></p><p id="23c2e0bc-559c-80a5-8ca3-ecb0a816e86b" class=""><strong>Which host gets notified when the 1756-L61/B LOGIX5561 card undergoes a PLC status change?</strong></p><p id="23c2e0bc-559c-8039-b946-c47147f25fcd" class="">🟢 Query 101  —→ index=* &quot;status change&quot; AND (&quot;1756-L61&quot; OR &quot;LOGIX5561&quot;)</p><p id="23c2e0bc-559c-80dd-9651-d0fe4257f970" class="">Expand date range to the whole month of January 2022 </p><figure id="2412e0bc-559c-80d1-bd9b-f3d481718648" class="image"><a href="image.png"><img style="width:709.9375px" src="image.png"/></a></figure><p id="2412e0bc-559c-8019-85bf-ce6cad45c08a" class="">A PLC status change happens when the controller switches between modes like RUN (normal operation), PROGRAM (making changes), or FAULT (something went wrong). These changes can be part of normal work, like updates or restarts, but if they happen unexpectedly, they might be a sign of a problem or even an attack. The PLC talks to sensors and machines, so any change in its status is important. When this happens, it usually sends a message to another computer, for example an engineering workstation, that’s set up to watch for these changes. Knowing which computer gets this message helps us understand who is monitoring the system and whether anything suspicious is happening.<br/><br/></p><p id="2412e0bc-559c-805b-bdfb-ecfe776fcb95" class="">🟢 Query 102  As in many industries, there are multiple differently named manufactures and companies. Being able to identify what you have, including the make, model, and firmware can assist you in being proactive to hardware and/or firmware vulnerabilities.</p><p id="2412e0bc-559c-80a8-bdf1-fac2e691b0cd" class=""><strong>Question: Based on the previous question, who is the manufacturer of the card?</strong></p><p id="2412e0bc-559c-80ec-bda0-dcdf4a280117" class="">Answer guidance: Provide the manufacturer for the PLC Processor Module</p><p id="2412e0bc-559c-80c0-b13c-d842a69638ab" class="">🔎 The makers of the PLC  is Allen-Bradley </p><p id="2412e0bc-559c-80ef-89ab-c331728d6473" class="">
</p><p id="23c2e0bc-559c-80aa-a1f1-eed17b1edfb5" class="">🟢 Query 103—&gt; </p><p id="2412e0bc-559c-80de-8d25-cddf15111910" class="">Knowing technical specifications of hardware can help with system designs and requirements. This can include software and hardware specs.</p><p id="2412e0bc-559c-80ad-af00-c68c4f3c8d8d" class=""><strong>Question: Based on the answer in question 102, answering in MB, how large is the user memory on the previously identified controller?</strong></p><p id="2412e0bc-559c-8014-8142-e1405fa476be" class="">The manufacturer is Allen-bradley and the user memory space is 2 MB. </p><p id="2412e0bc-559c-808f-9879-dfca3731ce83" class="">
</p><p id="2412e0bc-559c-80de-bed0-c26195bba905" class="">🟢 Query 104 —&gt; Along with knowing technical specifications of hardware, knowing built-in ports can help with upgrading systems and determining compatibility.</p><p id="2412e0bc-559c-80b3-a751-ca033cfbf0b4" class=""><strong>Question: What is the built-in COM (communication) port? RS-232 </strong></p><p id="2412e0bc-559c-80f3-ade1-e4c67230f732" class="">
</p><p id="23c2e0bc-559c-80fc-a52e-ea5c2e57daeb" class="">🟢 Query 105—&gt; Many malicious actors may seek to establish C2, command and control to maintain a foothold or establish persistence within a target environment.</p><p id="2412e0bc-559c-8089-8837-dc272eb493cb" class=""><strong>Question: What is the destination IP address of the TCP reverse shell that was detected?</strong></p><p id="2412e0bc-559c-80d6-b0ff-cc9c00148079" class=""> 🔎 index=* (&quot;reverse shell&quot; OR &quot;C2&quot; OR &quot;command and control&quot;)</p><p id="23c2e0bc-559c-8036-b8ac-c416be4efc19" class="">
</p><p id="23c2e0bc-559c-80dc-8d80-cbe74f6b22a0" class="">🟢 Query 106—&gt; SMB is a common network protocol used to establish connections to remote systems and servers.</p><p id="2412e0bc-559c-8027-b0f7-cabe1714ba4c" class=""><strong>Question:What was the hostname that was connected to with a SMB command shell?</strong></p><p id="23c2e0bc-559c-8034-90a7-e9d87a63a9ac" class=""> 🔎 index=* &quot;smb command shell”</p><figure id="2412e0bc-559c-807b-9326-f90a5263b546" class="image"><a href="image%201.png"><img style="width:649px" src="image%201.png"/></a></figure><p id="23c2e0bc-559c-805a-9fcb-c83fe1219a3d" class="">
</p><p id="23c2e0bc-559c-80fe-90e0-d7c9b79f630f" class="">🟢 Query 107—&gt;  Pylogix script as a lab simulation </p><p id="2412e0bc-559c-80be-a7dc-e39262e33788" class="">Pylogix is a tool written in python that allows users to read/write tag values in different types of PLCs.</p><p id="2412e0bc-559c-8074-be51-eebb9862962e" class=""><strong>Question: If you were going to use the tool &#x27;pylogix&#x27;, what config file parameter needs to change in order to set the slot number? processorslot </strong></p><p id="2412e0bc-559c-80ae-a4f6-d2c07f00fb55" class="">Answer guidance: Provide the command to specify the slot number when using pylogix. You do not need to answer with the full syntax including Python.</p><p id="23c2e0bc-559c-80ee-9a63-c852d7086ae1" class="">🟢 Query 108 —&gt; Pylogix is a powerful tool that allows you to also route traffic through other devices.</p><p id="2412e0bc-559c-80e7-8b3c-df348ebd3055" class=""><strong>Question:Using pylogix, what value is used to read a tag by routing through another device?</strong></p><p id="2412e0bc-559c-8091-b35c-c471a0dd4820" class="">Answer guidance: Provide the command to read a tag by routing with pylogix. You do not need to answer with the full syntax including Python</p><p id="2412e0bc-559c-807e-b323-ce12b43f16a5" class="">
</p><p id="2412e0bc-559c-8044-a972-d595579dc19a" class="">🟢 Query 109—→ Pylogix is also useful for enumeration. With great power comes great responsibility and enumerating PLCs and ICS assets should be taken with extreme care due to sensitivity.</p><p id="2412e0bc-559c-808c-83f6-f3ce1a0d3d6b" class=""><strong>Question: Using pylogix, what value is used to enumerate and get all controller and program tags?</strong></p><p id="2412e0bc-559c-807e-8bec-f38b652dc5dc" class="">Answer guidance: Provide the command to enumerate all controllers and tags using pylogix. </p><p id="2412e0bc-559c-80cc-96ea-c62eaa599f88" class="">
</p><p id="2412e0bc-559c-80e8-8b20-d62cb7798d22" class="">🔎 index=* &quot;write tag&quot;</p><p id="2412e0bc-559c-8046-8a2a-cc6de81b13ea" class="">
</p><figure id="2412e0bc-559c-80eb-b424-c487cc5e55c2" class="image"><a href="image%202.png"><img style="width:709.953125px" src="image%202.png"/></a></figure><p id="2412e0bc-559c-80f4-b5dc-db918a111135" class="">
</p><p id="2412e0bc-559c-8058-8428-d04ea184fe71" class="">🟢 Query 110 </p><p id="2412e0bc-559c-80ae-bf4b-c952c6123f13" class="">Metasploit is a penetration testing tool suite that can help create payloads, establish C2 and contains multiple public exploits.</p><p id="2412e0bc-559c-804c-87d2-e8f72a861ad0" class=""><strong>Question: On which hostname was the Metasploit alert for detected windows/speak_pwned run against? </strong>Answer guidance: Provide the hostname</p><p id="23c2e0bc-559c-8003-b7b3-d6d56fdc677e" class=""> 🔎 index=* speak_pwned </p><p id="2412e0bc-559c-80f8-b564-c28352f63f94" class="">choose create table view output</p><figure id="2412e0bc-559c-8023-942e-ea5987cf5e35" class="image"><a href="image%203.png"><img style="width:595px" src="image%203.png"/></a></figure><p id="2412e0bc-559c-8041-b61d-fe99caceea40" class="">
</p><p id="2412e0bc-559c-8096-9df6-fa6c64d9dba6" class="">🟢 Query 111 —&gt; While PowerShell is a powerful tool for automation and system administration, there are additional capabilities in the form of PowerShell frameworks that are leveraged for offensive capabilities.</p><p id="2412e0bc-559c-80c8-b4c6-ffd33839dafb" class=""><strong>Question: What offensive PowerShell tool was used by the adversary?</strong></p><p id="23c2e0bc-559c-80ba-801e-e47ae3fb1223" class="">🔎 index=* powershell</p><figure id="2412e0bc-559c-80d5-915f-cd13c6c3bd52" class="image"><a href="image%204.png"><img style="width:585px" src="image%204.png"/></a></figure><p id="23c2e0bc-559c-8009-b99b-dea1e4dd1401" class="">
</p><p id="2412e0bc-559c-801e-a9b8-deece0912976" class="">🟢 Query 112 —&gt; The MS17-010 exploit is also famously known as EternalBlue. This exploit targets SMBv1 for all versions of Windows operating systems. In Windows 10, Windows Servers 2012 and newer, SMBv1 comes disabled by default. </p><p id="2412e0bc-559c-80d4-b539-f6495d70de5c" class=""><strong>Question: MS17-101 was run against a target. What was the target&#x27;s MAC address?</strong></p><p id="2412e0bc-559c-805e-96c5-d366f39aba4b" class="">Answer guidance: Provide the MAC address of the targeted system.</p><p id="23c2e0bc-559c-80bb-8e5b-f98feb531c9c" class="">🔎 index=* &quot;exploit&quot; OR &quot;smb&quot; OR &quot;MS17”</p><figure id="23c2e0bc-559c-808e-93a4-e149080f712b" class="image"><a href="image%205.png"><img style="width:610px" src="image%205.png"/></a></figure><p id="23c2e0bc-559c-80cd-a966-d45b976ae22f" class="">
</p><p id="2412e0bc-559c-8040-9475-da5e35a6da90" class="">
</p><p id="2412e0bc-559c-80ca-b39e-f8b3b0c162ed" class="">🟢 Query 113—&gt; Being able to identify which objects, fields or values are being changed can indicate possible malicious intent. Especially if those objects are not normally changed by different systems or devices.</p><p id="2412e0bc-559c-80d4-be68-c3f58257ac3b" class=""><strong>Question:</strong></p><p id="2412e0bc-559c-80ef-b40f-c20dd8d6831e" class=""><strong>Which host attempted to modify the Usermemory object on the host 192.168.1.6 more than once?</strong></p><p id="2412e0bc-559c-80cf-9424-de3b71032184" class="">Answer guidance: Provide the IPv4 address.</p><p id="23c2e0bc-559c-80d5-bf59-f1e6e439af97" class=""> #index=*  dest_ip=&quot;192.168.1.6&quot; &quot;Usermemory&quot;  </p><figure id="23c2e0bc-559c-80a2-aa17-efe56eadeefe" class="image"><a href="image%206.png"><img style="width:576px" src="image%206.png"/></a></figure><p id="23c2e0bc-559c-8063-955e-edaba61cdf0e" class="">
</p><p id="23c2e0bc-559c-80fc-843e-f51654c39333" class=""> 🟢 Query 114 —&gt; A CIP connection is simply a connection between two devices, normally with a PLC. One type of error that can create an alert is of loss of connection. This is just one of many failures that can occur and be alerted upon.</p><p id="23c2e0bc-559c-80dc-9977-feeba66efacf" class=""><strong>Question: Host 192.168.1.200 received a CIP error indicating an unauthorized command from host 192.168.1.6. What type of request created the alert?</strong></p><p id="23c2e0bc-559c-809b-8301-d66c5df3aa8e" class=""> 🔎 index=* src=192.168.1.6  (&quot;cip&quot; OR &quot;unauthorized&quot; OR &quot;error&quot;)</p><p id="23c2e0bc-559c-8076-aef4-edf1ec83d5c1" class="">
</p><figure id="23c2e0bc-559c-8048-9e8e-f8850da23e87" class="image"><a href="image%207.png"><img style="width:593px" src="image%207.png"/></a></figure><p id="2412e0bc-559c-8020-b0f6-f763b2b1ef73" class="">
</p><p id="2412e0bc-559c-80d5-8cb8-f853063a0bba" class=""> 🟢 Query 115 —&gt; Port scans are useful for enumeration. Port scanning can show open ports and possible protocols and version numbers on different devices on the network. They can create visibility and help define your network footprint and what is being exposed across the network.</p><p id="2412e0bc-559c-808c-9fe7-f44d8244ea2d" class=""><strong>Question: There was a port scan initiated at 03:06. Providing the port number only, what was the highest port number scanned?</strong></p><p id="2412e0bc-559c-80a5-bed9-e09f6d032c3f" class=""> 🔎 index=* &quot;port scan”</p><figure id="2412e0bc-559c-8010-9db3-d231005525ac" class="image"><a href="image%208.png"><img style="width:607px" src="image%208.png"/></a></figure><p id="2412e0bc-559c-8097-9525-f058d94c90a8" class=""> </p><p id="2412e0bc-559c-80ef-a0bd-c1697c1eb3bc" class="">🟢 Query 116—&gt; Being able to identify which systems are scanning others, along with being able to determine which systems can communicate with others are examples of good network visibility and hygiene. Firewall rules and additional considerations should be in place to reduce the amount of necessary communication across networks to reduce the attack surface or footprint.</p><p id="2412e0bc-559c-8059-b4b5-fe24ddb35f20" class=""><strong>Question: Based on the previous question, what is the hostname of where the scanner originated?</strong></p><p id="2412e0bc-559c-802b-879a-f4dccd01cb68" class="">refer to the src_host value</p><p id="2412e0bc-559c-8035-842a-ce597eeaf3f3" class="">🔎</p><p id="2412e0bc-559c-8013-aafd-dab0a0594f5d" class="">
</p><p id="2412e0bc-559c-80de-954a-c6d2f00933cf" class=""> 🟢 Query 117—&gt; There are multiple ways to detect access to systems, known as different access techniques. Being to detect, log and alert on the different types of access techniques will increases your overall cyber security posture.</p><p id="2412e0bc-559c-805a-a4d5-fd5930046095" class=""><strong>Question: Host 192.168.193.12 sent a file from 192.168.2.2. What was the access technique used?</strong></p><p id="2412e0bc-559c-80bb-90ac-fd314378a6df" class="">  🔎 index=* src=&quot;192.168.193.12&quot; dest=&quot;192.168.2.2”</p><figure id="2412e0bc-559c-8053-a943-c5e2a91153d1" class="image"><a href="image%209.png"><img style="width:583px" src="image%209.png"/></a></figure><p id="2412e0bc-559c-8085-b939-d6b2fda0fb43" class="">In the above, the attacker did not provide any authentication credentials, it was done on their behalf by the operating system.</p><p id="2412e0bc-559c-80ef-b863-e3903b7f2e67" class="">
</p><p id="2412e0bc-559c-80d7-b5e2-ce1ca84e9ef3" class=""> 🟢 Query 118—&gt; Adversaries can use reverse shells or other types of connections from hosts back to their machines for established C2. Being able to differentiate between normal connections and anomalies may help highlight activity in the environment that may be malicious.</p><p id="2412e0bc-559c-8081-91a1-fe77436c4690" class=""><strong>Question: There was a Metasploit reverse TCP shell detected, started from 10.0.0.128. Provide the IPv4 address of where it was connecting to.</strong></p><p id="2412e0bc-559c-80e5-9a00-ce1c6f30c923" class="">Answer guidance: Provide the IPv4 address.</p><p id="2412e0bc-559c-80dc-89dc-ca1a8f40c526" class="">🔎 index=* src=&quot;10.0.0.128&quot; &quot;reverse tcp shell”</p><figure id="2412e0bc-559c-8065-84d8-c78ccedd4c07" class="image"><a href="image%2010.png"><img style="width:594px" src="image%2010.png"/></a></figure><p id="2412e0bc-559c-8054-b422-fbddef5d11fc" class="">
</p><p id="2412e0bc-559c-804f-9bb6-e30d96257ecf" class="">🟢 Query 119—&gt; Pycomm3 is an open source python library for communicating with Allen-Bradley PLCs using Ethernet/IP. As the name suggests, pycomm3 is for python 3 from it&#x27;s python 2 predecessor, pycomm. </p><p id="2412e0bc-559c-804e-9a3b-f02e83179d83" class=""><strong>Question: What is the IPv4 address of the host that uses pycomm3 the most?</strong></p><p id="2412e0bc-559c-8065-9b2e-cde9beb64cd9" class="">🔎  # index=* &quot;pycomm3&quot;<br/>| stats count by src_ip (count the number of time each src ip appears)<br/>| sort - count  (sort by most used to be first)<br/>| head 1 ( then display the  first)<br/>| table src_ip (plus display in a table)<br/></p><figure id="2412e0bc-559c-8002-92a8-cbcac6b3e2fa" class="image"><a href="image%2011.png"><img style="width:609px" src="image%2011.png"/></a></figure><p id="2412e0bc-559c-8016-b7b8-efcbfd666a14" class="">
</p><p id="2412e0bc-559c-8089-a1f0-e5b984448f18" class="">🟢 Query 120—&gt; Not only can pycomm3 read files in different PLCs, but it can also write changes as well. The documentation, instructions and README files with programs are very informative regarding the full capabilities of tools.</p><p id="2412e0bc-559c-803c-9b17-dfd4c293615e" class=""><strong>Question: What protocol does Pycomm3 to use to read and write tag values?</strong></p><p id="2412e0bc-559c-8064-a76c-d693d0beabf4" class="">🔎 index=* &quot;pycomm3”</p><figure id="2412e0bc-559c-80d8-b754-f1116847a3ba" class="image"><a href="image%2012.png"><img style="width:709.96875px" src="image%2012.png"/></a></figure><p id="2412e0bc-559c-8049-bac5-e6f5777158f9" class="">
</p><p id="2412e0bc-559c-8026-98a3-c5296404e618" class=""><strong>🟢 Query </strong>121 —&gt;Reading data from PLCs can be beneficial for checking values, settings and configurations.</p><p id="2412e0bc-559c-801d-a7b4-d26d8afe3c3f" class=""><strong>Question: What type of data can be used with the ‘request_data’ command?</strong></p><p id="2412e0bc-559c-8033-b85d-dfc52d533190" class="">
</p><p id="2412e0bc-559c-80f6-ab53-c7c122bc2f66" class="">🟢 Query <strong>122 —&gt; </strong>There are multiple drivers in pycomm3, that each add their own support for different devices or PLCs</p><p id="2412e0bc-559c-8029-9eac-ef6e9abf5813" class=""><strong>Question: In alphabetical order, and separated by commas, i.e. a,b,c - What three drivers come installed with pycomm3?</strong></p><p id="2412e0bc-559c-807b-a13a-ed0674ce1580" class="">
</p><p id="2412e0bc-559c-80eb-b1cd-d344aa585e88" class="">
</p><p id="2412e0bc-559c-802c-8447-d4b16af8e3a7" class="">🟢 Query 123 —&gt; </p><p id="2412e0bc-559c-80ee-a71d-e6f805b3add6" class="">Understanding applicability of tools and programs is useful when testing. Some tools are specific to one system or device. Others may be applied to more than one.</p><p id="2412e0bc-559c-8063-ac7e-c7494ba033e0" class=""><strong>Question: What type of PLCs can be used with Pycomm3</strong></p><p id="2412e0bc-559c-8089-98b7-c5d1149bdf48" class="">Answer guidance: Provide the manufacturers with a comma separating each one. For example: alpha,gamma </p><p id="2412e0bc-559c-806a-a4db-c242d1e92bae" class="">
</p><p id="2412e0bc-559c-8019-8803-fa0af7ca8041" class="">🟢 Query 124—&gt; Being able to search for and identify asset information within your monitoring solutions is important to be able to verify vulnerabilities, as well as identify exploitation attempts on those vulnerable assets.</p><p id="2412e0bc-559c-80bb-9bc1-f32ddcff1a96" class=""><strong>Question: What is the IP address of the Honeywell DSA Primary?</strong></p><p id="2412e0bc-559c-8056-8915-fef801da927d" class="">🔎 index=* (&quot;Honeywell&quot; OR &quot;DSA&quot;) AND &quot;Primary”</p><figure id="2412e0bc-559c-80fb-ae7a-dfb6418b17f6" class="image"><a href="image%2013.png"><img style="width:575px" src="image%2013.png"/></a></figure><p id="2412e0bc-559c-8068-a1d6-e6ed2632ca3e" class="">
</p><p id="2412e0bc-559c-80b5-8c29-ec7bb05ab501" class="">🟢  Query 125—&gt; Not all adversaries use proprietary software, malware, and tools to gain access to systems. Being able to detect open source and popular tools available online can upgrade detection capabilities.</p><p id="2412e0bc-559c-808f-9570-d3402f5d3625" class=""><strong>Question: What popular shell was used to execute commands on remote hosts from the MSSQL server?</strong></p><p id="2412e0bc-559c-80c1-9616-d78931cd9867" class="">🔎 #index=* &quot;shell&quot; OR &quot;mssql”</p><p id="2412e0bc-559c-8027-8e35-d55b138dafe3" class="">
</p><figure id="2412e0bc-559c-80c4-b6fa-da530db42ff2" class="image"><a href="image%2014.png"><img style="width:598px" src="image%2014.png"/></a></figure><p id="2412e0bc-559c-8069-b7cf-d5561080e422" class="">🔎 index=*  &quot;xp_cmdshell”</p><figure id="2412e0bc-559c-80ea-acf4-c5d44446c5e2" class="image"><a href="image%2015.png"><img style="width:592px" src="image%2015.png"/></a></figure><p id="2412e0bc-559c-80a7-967f-d0b4632221f8" class="">
</p><p id="2412e0bc-559c-8054-b67c-c6f5d60fb1f0" class="">🟢 <strong>Query #126 —&gt; </strong>Mitigation of some vulnerabilities are as simple as turning off some commands or functionality, that may be turned on by default. As always, confirm with your vendor, OEM, system integrator before turning anything off to ensure it is not needed for operational use.</p><p id="2412e0bc-559c-8048-a189-cb31292beee1" class=""><strong>Question: By default that command is disabled. What command is used to enable it?</strong></p><p id="2412e0bc-559c-806f-86e8-fdd10ab99210" class="">  Research sp_configure </p><p id="2412e0bc-559c-8078-aa7d-dfd9feb061f8" class="">🟢 <strong>Query 127 —&gt;  Asset 21151 was potentially compromised. What was the first notification related to the asset after compromise was detected?</strong></p><p id="2412e0bc-559c-80ec-b88d-dece83f7ee1d" class="">🔎 index=* &quot;21151&quot;<br/>| sort -_time<br/></p><p id="2412e0bc-559c-80a6-97fb-cd3354067104" class="">
</p><figure id="2412e0bc-559c-8000-a0bd-dc1d0d6f1bcb" class="image"><a href="image%2016.png"><img style="width:709.984375px" src="image%2016.png"/></a></figure><p id="2412e0bc-559c-8037-af3f-d824e94b4581" class="">
</p><p id="2412e0bc-559c-8017-beda-c399c6cf9917" class="">🟢  Query 128—→ Downloading files could be an indication of malicious intent. It could be either an adversary trying to download files to a device, or possibly attempting to exfiltrate information. Being able to detect these actions on a network can alert upon possible compromise. Sometimes it may be part of normal operations of an OT environment, such as copying data to a historian.</p><p id="2412e0bc-559c-801b-a21c-ce492211a1da" class=""><strong>Question: One of the hosts on the network is used for running certain pieces of Siemens software and is named accordingly. It looks like one of the hosts was attempting to download a file multiple times. What is the IPv4 address of the destination it was trying to download the file from?</strong></p><p id="2412e0bc-559c-806e-ac5f-e6f9e5baa99b" class="">Answer guidance: Provide the IPv4 address of the destination the Siemens host machine was trying to download the software from.</p><p id="2412e0bc-559c-8064-a644-ffc104cddde9" class="">
</p><p id="2412e0bc-559c-8021-a315-cbca9ed43eab" class="">🟢Query <strong>129—&gt; </strong>The type of files being downloaded can make a difference as well. Being able to detect upon different file extensions can help improve detection capabilities.</p><p id="2412e0bc-559c-80f1-889e-f746edc2c019" class=""><strong>Question: Referring to the previous question, what was the extension of the file that was downloaded?</strong></p><p id="2412e0bc-559c-808b-bbed-d8993c81e279" class="">🟢 Query <strong>130—&gt; </strong>An obfuscation strategy often found is that of ports and protocols attempting usage to non-default ports as a method to obfuscate the systems on the network. While a quick enumeration is a good place to get started, it may not give the full picture of a network.</p><p id="2412e0bc-559c-80c7-92ef-d2045da5fc95" class=""><strong>Question: What is the source IP address that tried to negotiate RDP on port 55555?</strong></p><p id="2412e0bc-559c-806e-901f-e31216ea1a19" class="">🟢 Query <strong>131—&gt; </strong>RDP (Remote Desktop Protocol) is a windows tool that provides the user access to another system remotely.</p><p id="2412e0bc-559c-809a-95d8-f3679ff3fc93" class=""><strong>Question: What is the common port number used for RDP?</strong></p><p id="2412e0bc-559c-80f7-87f2-d8e60986cd9e" class="">Answer guidance: Provide the port number commonly used for RDP</p><p id="2412e0bc-559c-8010-ad31-faa5808acae1" class="">🟢 Query 132—&gt; RDP is a normal method for users and operators to access workstations and similar servers within a different network domain. Firewall rules and DMZ should be configured correctly to limit the connections between the different zones.</p><p id="2412e0bc-559c-8035-a3a1-c473fb4d3b1d" class=""><strong>Question: During a forwarded RDP Negotiation request with a nonstandard destination port with a Dragos Source ID of 7834, what was the destination host name?</strong></p><p id="2412e0bc-559c-8050-8a38-cbe461db1d3e" class="">🟢 Query 133—&gt; A historian is a system used to collect and store logs or process data from SCADA or similar devices. They are usually configured to automatically log and process data from those environments.</p><p id="2412e0bc-559c-8076-8407-c4ba674d9c54" class=""><strong>Question: What is the Dragos ID number of the rshistorian host?</strong></p><p id="2412e0bc-559c-8045-ba0d-f6abbbd313a5" class="">🟢 Query 134 —&gt; Nmap is a popular open-source enumeration tool to scan networks for hosts. Nmap can also provide open ports, protocols, version numbers and more; depending on the systems or devices being scanned</p><p id="2412e0bc-559c-8016-8fb0-cae2570a89ee" class=""><strong>Question: Which test asset IP address was scanned by NMAP from the source IP of 192.168.208.1?</strong></p><p id="2412e0bc-559c-800a-a61a-eb8cec18580b" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>